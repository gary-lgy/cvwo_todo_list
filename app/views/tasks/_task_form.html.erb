<%# form to build a new task or edit and existing task %>
<%= form_with model: @task, local: true do |f| %>
  <fieldset>
    <legend>Details</legend>
    <p>
      <%= f.label :title, 'Title: ' %>
      <%= f.text_field :title, required: true, autocomplete: :off %><br>
    </p>
    <p>
      <%= f.label :description, 'Description: ' %>
      <%= f.text_area :description, size: '30x5', maxlength: 250 %><br>
    </p>
    <p>
      <%= f.label :deadline, 'Deadline: ' %>
      <%= f.datetime_select :deadline,
            selected: utc_to_user_time(@task.deadline || Time.zone.now) %><br>
    </p>
    <%# display each tag and give user the option to remove them %>
    Tags:
    <p>
      <% @task.tags.each do |tag| %>
        <div class="tag">
          <%= tag.name %>
          <%= hidden_field_tag 'task[tags][][name]', tag.name %>
          <%= hidden_field_tag 'task[tags][][remove]' %>
          <%# JavaScript link to mark the 'remove'
              field and hide the div %>
          <%= link_to 'Remove', '#', id: 'remove_tag' %>
          <br>
        </div>
      <% end %>
    </p>
    <%# JavaScript link to add a new tag %>
    <p>
      <%= link_to_add_tag %>
    </p>
    <p>
      <%= f.submit %>
    </p>
  </fieldset>
<% end %>

<%= link_to_tasks_path %>
